version: '3'

services:
  tele:
    image: mlan/asterisk
    network_mode: bridge # Only here to help testing
    cap_add:
      - sys_ptrace       # Only here to help testing
      - net_admin
      - net_raw
    ports:
      - "${SMS_PORT-8080}:80"
      - "9960:9960/udp"
      - "9960:9960"
      - "9961:9961"
      - "10000-10099:10000-10099/udp"
    environment:
      - SYSLOG_LEVEL=${SYSLOG_LEVEL-4}
      - HOSTNAME=${TELE_SRV-tele}.${DOMAIN-docker.localhost}
      - PULSE_SERVER=unix:/tmp/pulseaudio.socket
      - PULSE_COOKIE=/tmp/pulseaudio.cookie
    volumes:
      - tele-conf:/srv
      - ${XDG_RUNTIME_DIR}/pulse/native:/tmp/pulseaudio.socket
      - ${HOME}/.config/pulse/cookie:/tmp/pulseaudio.cookie
#    devices:
#      - /dev/snd
#    privileged: true

volumes:
  tele-conf:
